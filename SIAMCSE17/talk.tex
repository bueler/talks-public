\documentclass[hide notes,intlimits]{beamer}

\mode<presentation>
{
  \usetheme{Singapore}
  \usefonttheme{professionalfonts}
  \setbeamertemplate{blocks}[rounded][shadow=true]
  \setbeamercovered{transparent}
}

% load packages
\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[multidot]{grffile}
\usepackage{verbatim,empheq}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows}
\usetikzlibrary{decorations.pathreplacing}

\usepackage{animate}
\usepackage{amsmath,verbatim}

% see http://tex.stackexchange.com/questions/86188/labelling-with-arrows-in-an-automated-way

\newif\ifclipme\clipmetrue
\tikzset{labelstyle/.style={LabelStyle/.append style={#1}},linestyle/.style={LineStyle/.append style={#1}}}
\tikzset{LabelStyle/.initial={},LineStyle/.initial={}}

\newcommand{\mathWithDescription}[4][]{{%
    \tikzset{#1}%
    \tikz[baseline]{
        \node[draw=red,rounded corners,anchor=base] (m#4) {$\displaystyle#2$};
        \ifclipme\begin{pgfinterruptboundingbox}\fi
            \node[above of=m#4,font=\strut, LabelStyle] (l#4) {#3};
            \draw[-,red, LineStyle] (l#4) to (m#4);
        \ifclipme\end{pgfinterruptboundingbox}\fi
    }%
}}

\newcommand{\mathWithDescriptionStarred}[3][]{{%
    \clipmefalse%
    \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
}}

\newcounter{mathLabelNode}

\newcommand{\mathLabelBox}[3][]{%
   \stepcounter{mathLabelNode}%
   \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
   \vphantom{\mathWithDescriptionStarred[#1]{#2}{#3}{\themathLabelNode}}%
}

\definecolor{dark red}{HTML}{E41A1C}
\definecolor{dark green}{HTML}{4DAF4A}
\definecolor{dark violet}{HTML}{984EA3}
\definecolor{dark blue}{HTML}{084594}
\definecolor{dark orange}{HTML}{FF7F00}
\definecolor{light blue}{HTML}{377EB8}
\definecolor{light red}{HTML}{FB9A99}
\definecolor{light violet}{HTML}{CAB2D6}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\Kcal}{\mathcal{K}}
\newcommand{\Xcal}{\mathcal{X}}

\newcommand{\bF}{\mathbf{F}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bX}{\mathbf{X}}

\newcommand{\bq}{\mathbf{q}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bx}{\mathbf{x}}

\newcommand{\Div}{\nabla\cdot}
\newcommand{\eps}{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\lap}{\triangle}
\renewcommand{\bar}{\overline}

\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}


\newenvironment{transbox}[1][]{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,text width=\textwidth,fill=white, fill opacity=#1,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}}


%\title[Implicit time-stepping for the cryosphere]{Implicit time-stepping for the cryosphere}
\title{Implicit time-stepping for the cryosphere}

\author[Bueler]{Ed Bueler}

\institute[UAF]{
  \scriptsize Dept of Mathematics and Statistics and Geophysical Institute \\

  University of Alaska Fairbanks \\
  
  \tiny $^{}$ \\
  \tiny supported by NASA grant \# NNX13AM16G
}

\titlegraphic{\includegraphics[width=\textwidth]{andycoast.png}}

\setbeamerfont{date}{size=\scriptsize}
\date{}

\AtBeginSection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    %\tableofcontents[currentsection,hideallsubsections]
    \tableofcontents[currentsection]
  \end{frame}
}


\begin{document}

%\graphicspath{{figs/}{../commonfigs/}}
\graphicspath{{../commonfigs/}}

\begin{frame}
\vspace{10mm}
  \titlepage
  \begin{center}
  \tiny SIAM CSE \quad 2 March, 2017
  \end{center}
\end{frame}


\begin{frame}{ice sheet modeling goal: long time-integrations}

\begin{itemize}
\item \emph{goal}: simulate e.g.~northern hemisphere ice sheets for ice age cycle ($10^5$ years) at resolution where dated moraine etc.~evidence can be used as validation
\item ice geometry evolution problem is diffusive because ice flows downhill
\item \emph{so} implicit time stepping is natural desire
\end{itemize}
\end{frame}


\begin{frame}{numerical models}

\begin{itemize}
\item two models in mind:
    \begin{itemize}
    \item[$\circ$] shallow, thickness-based in $H,\mathbf{u}=(u,v)$
        \begin{align*}
        H_t + \Div (\mathbf{u} H) &= m(x,t) && \text{mass conservation} \\
        \mathcal{L}(\mathbf{u},H) &= 0      && \text{slow, shallow momentum conservation}
        \end{align*}
    \item[$\circ$] Stokes, surface-based in $h,\mathbf{u}=(u,v,w)$
        \begin{align*}
        h_t + \mathbf{u}\big|_h \cdot (h_x,h_y,-1) &= m(x,t) && \text{surface kinematical} \\
        \Div \mathbf{u} &= 0            && \text{incompressibility} \\
        \mathcal{L}(\mathbf{u},h) &= 0  && \text{Stokes stress eqns with BCs}
        \end{align*}
    \end{itemize}
\item assumed Eulerian
\item conservation of energy dropped for convenience
\end{itemize}
\end{frame}

\begin{frame}{approach: discretize in space}

\begin{itemize}
\item \emph{approach}: discretize in space and apply implicit time-stepping
    \begin{itemize}
    \item[$\circ$] \emph{i.e.} method of lines = MOL
    \item[$\circ$] \emph{i.e.} can you hand the ice sheet evolution problem to an ODE solver?
    \end{itemize}
\item well-known: spatial-discretization gives DAE system 
\begin{align*}
\dot H &= f(H,\mathbf{u},t) && \text{mass conservation} \\
     0 &= g(H,\mathbf{u})   && \text{momentum conservation}
\end{align*}
\vspace{-5mm}
    \begin{itemize}
    \item[$\circ$] implicit time-stepping required for DAEs anyway!
    \end{itemize}
\item velocity variables only exist at grid point $i$ if thickness is positive: \qquad $H\ge 0 \qquad \text{and} \qquad \mathbf{u}_i \text{ exists } \iff H_i > 0$

\bigskip
\item no problem! ODE solvers can handle \emph{events}:
    \begin{itemize}
    \item[$\circ$] $H_i>0 \quad \to \quad H_i=0$
    \item[$\circ$] $H_i=0 \quad \to \quad H_i>0$
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{approach: MOL + events}

\begin{center}
\input{tikz/molevents.tex}
\end{center}
\end{frame}


\begin{frame}{scary events}

\begin{itemize}
\item \emph{at each event the ice velocity dimension changes}:
    \begin{itemize}
    \item[$\circ$] ``active set'' constructs (e.g.~masks) apply to \emph{both} thickness and velocity variables
    \item[$\circ$] implicit time step solver must pay attention!
    \end{itemize}
\item \emph{events happen all the time on fine grids}:
    \begin{itemize}
    \item[$\circ$] margins of continental-scale ice sheets essentially fractal
    \item[$\circ$] some major climate impacts on scale of a few years (or days)
    \end{itemize}
\item at least: needs sophisticated ODE event handling!
\end{itemize}
\end{frame}




\begin{frame}{weak formulation by variational inequality} 
\begin{itemize}
\item define closed and convex admissible set
  $$\Kcal := \{\eta : \eta^{2p/(p-1)} \in W^{1,p}_0 (\Omega) \,\text{and}\, \eta \ge 0\}$$
over larger domain $\Omega \subset \RR^2$
\item multiply strong form by $\eta-H$ where $\eta\in \Kcal$, and integrate by parts thoughtfully
\end{itemize}
\begin{block}{definition} 
$H \in \Kcal$ solves the \emph{steady shallow ice sheet problem} if
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
for all $\eta \in \Kcal$
\end{block}
\end{frame}


\begin{frame}{ideas contained in weak formulation} 
\begin{itemize}
\item weak form
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
implies strong form
  $$-\Div \left(\Gamma H^{p+1} |\nabla s|^{p-2} \nabla s  \right) =  a$$
where $H>0$
\item weak form also implies: if $H=0$ then $a \le 0$
\item if $b=0$ then the weak form is equivalent to a constrained minimization problem
  \begin{itemize}
  \item[$\circ$] for general bed $b$ this is not so
  \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{on well-posedness (Jouvet-Bueler 2012)} 
\begin{block}{theorem A.}
if $b=0$ then the variational inequality is equivalent to
  $$\min \, J[u] = \int_{\Omega} \frac{\Gamma}{p} |\grad u|^p - a u$$
over $\eta = u^{(p-1)/(2p)} \in \Kcal$, and this problem is well-posed (existence, uniqueness, stability w.r.t.~data $a$)
\end{block}
\begin{block}{theorem B.}
in general case ($b\ne 0$) there exists a solution
\end{block}
\begin{itemize}
\item proof of B by a fixed-point theorem, of course
\item we really don't know about uniqueness (not just technical)
\end{itemize}
\end{frame}

\end{document}
