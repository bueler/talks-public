\documentclass[hide notes,intlimits,usenames,dvipsnames]{beamer}

\mode<presentation>
{
  \usetheme{Singapore}
  \usefonttheme{professionalfonts}
  \setbeamertemplate{blocks}[rounded][shadow=true]
  \setbeamercovered{transparent}
}

% load packages
\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[multidot]{grffile}
\usepackage{verbatim,empheq}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows}
\usetikzlibrary{decorations.pathreplacing}

\usepackage{animate}
\usepackage{amsmath,verbatim}
%\usepackage[dvipsnames]{xcolor}

% see http://tex.stackexchange.com/questions/86188/labelling-with-arrows-in-an-automated-way

\newif\ifclipme\clipmetrue
\tikzset{labelstyle/.style={LabelStyle/.append style={#1}},linestyle/.style={LineStyle/.append style={#1}}}
\tikzset{LabelStyle/.initial={},LineStyle/.initial={}}

\newcommand{\mathWithDescription}[4][]{{%
    \tikzset{#1}%
    \tikz[baseline]{
        \node[draw=red,rounded corners,anchor=base] (m#4) {$\displaystyle#2$};
        \ifclipme\begin{pgfinterruptboundingbox}\fi
            \node[above of=m#4,font=\strut, LabelStyle] (l#4) {#3};
            \draw[-,red, LineStyle] (l#4) to (m#4);
        \ifclipme\end{pgfinterruptboundingbox}\fi
    }%
}}

\newcommand{\mathWithDescriptionStarred}[3][]{{%
    \clipmefalse%
    \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
}}

\newcounter{mathLabelNode}

\newcommand{\mathLabelBox}[3][]{%
   \stepcounter{mathLabelNode}%
   \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
   \vphantom{\mathWithDescriptionStarred[#1]{#2}{#3}{\themathLabelNode}}%
}

\definecolor{dark red}{HTML}{E41A1C}
\definecolor{dark green}{HTML}{4DAF4A}
\definecolor{dark violet}{HTML}{984EA3}
\definecolor{dark blue}{HTML}{084594}
\definecolor{dark orange}{HTML}{FF7F00}
\definecolor{light blue}{HTML}{377EB8}
\definecolor{light red}{HTML}{FB9A99}
\definecolor{light violet}{HTML}{CAB2D6}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\Kcal}{\mathcal{K}}
\newcommand{\Xcal}{\mathcal{X}}

\newcommand{\bF}{\mathbf{F}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bX}{\mathbf{X}}

\newcommand{\bq}{\mathbf{q}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bx}{\mathbf{x}}

\newcommand{\Div}{\nabla\cdot}
\newcommand{\eps}{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\lap}{\triangle}
\renewcommand{\bar}{\overline}

\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}


\newenvironment{transbox}[1][]{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,text width=\textwidth,fill=white, fill opacity=#1,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}}


\title[Implicit time-stepping for ice sheets]{Implicit time-stepping for ice sheets}

\author[Bueler]{Ed Bueler}

\institute[UAF]{
  \scriptsize Dept of Mathematics and Statistics and Geophysical Institute \\

  University of Alaska Fairbanks \\
  
  \tiny $^{}$ \\
  \tiny supported by NASA grant \# NNX13AM16G
}

\titlegraphic{\includegraphics[width=\textwidth]{andycoast.png}}

\setbeamerfont{date}{size=\scriptsize}
\date{}

\AtBeginSection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    %\tableofcontents[currentsection,hideallsubsections]
    \tableofcontents[currentsection]
  \end{frame}
}


\begin{document}

%\graphicspath{{figs/}{../commonfigs/}}
\graphicspath{{../commonfigs/}}

\begin{frame}
\vspace{10mm}
  \titlepage
  \begin{center}
  \tiny SIAM CSE \quad 2 March, 2017
  \end{center}
\end{frame}


\begin{frame}{ice sheets and their boundaries}
\begin{columns}
\begin{column}{0.4\textwidth}
\begin{itemize}
\item<1> nearly-fractal free boundaries determined by topography and climate interaction
\item<2> large fraction of the boundary: grounded margins
\item<3> surface slope is discontinuous at grounded margins
\end{itemize}
\end{column}
\begin{column}{0.6\textwidth}
\only<1>{\includegraphics[height=0.78\textheight]{ice-mask-900m.png} \\ {\tiny \hfill PISM mask, by A.~Aschwanden}}
\includegraphics<2>[height=0.8\textheight]{jako-crop-mask-900m.png}
\only<3>{\includegraphics[width=1.02\textwidth]{truffertaku2016.jpg} \\ {\tiny \hfill Taku Glacier, Alaska, by M.~Truffer}}
\end{column}
\end{columns}
\end{frame}


\begin{frame}{modeling goal: long-time, high-res runs}

\begin{itemize}
\item goal:
\begin{quote}
simulate ice sheets for natural time scales (ice age cycles \alert{$\sim 10^5$ years}) at resolution where outlet glaciers, ice streams, and grounding lines are resolved (\alert{$\sim 500$ m})
\end{quote}
\item main concerns:
    \begin{enumerate}
    \item evolution of ice thickness $H(t,x,y)$ is largely diffusive
        \begin{itemize}
        \item[$\circ$] because ice flows downhill
        \item[$\circ$] natural desire: implicit time-stepping
        \end{itemize}
    \item ice margins are steep
        \begin{itemize}
        \item[$\circ$] because of constraint ($H\ge 0$) and degeneracy (stresses $\to 0$ at margins \emph{and} ice is shear-thinning)
        \end{itemize}
    \item bedrock is steep
    \end{enumerate}
\end{itemize}
\end{frame}


\begin{frame}{ice sheet models}

\begin{itemize}
\item $H$ thickness, $h$ surface elevation, $\mathbf{u}$ velocity
\item two models in mind:
    \begin{itemize}
    \item[$\circ$] shallow, possibly-hybrid, thickness-based \hfill {\scriptsize\color{Gray} $H,\, \mathbf{u}=(u,v)$}
        \begin{align*}
        H_t + \Div (-D \grad H + \mathbf{u} H) &= m(x,t) && \text{mass conservation} \\
        \mathcal{L}(\mathbf{u},H) &= 0      && \text{shallow stress balance}
        \end{align*}
    \item[$\circ$] Stokes, surface-elevation-based \hfill {\scriptsize\color{Gray} $h,\, \mathbf{u}=(u,v,w)$}
        \begin{align*}
        h_t + \mathbf{u}\big|_h \cdot (h_x,h_y,-1) &= m(x,t) && \text{surface kinematical} \\
        \Div \mathbf{u} &= 0            && \text{incompressibility} \\
        \mathcal{L}(\mathbf{u},h) &= 0  && \text{Stokes stress balance}
        \end{align*}
    \end{itemize}
\item assumptions:
    \begin{itemize}
    \item[$\circ$] conservation of energy ignored for simplicity
    \item[$\circ$] Eulerian, fixed grid (structured or not)
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{discretize in space?}

\begin{itemize}
\item discretize in space and apply implicit time-stepping
    \begin{itemize}
    \item[$\circ$] method of lines (MOL)
    \item[$\circ$] \emph{can you hand the ice sheet problem to an ODE solver?}
    \end{itemize}
\item well-known: MOL for slow fluids is a DAE problem
\begin{align*}
\dot H &= f(H,\mathbf{u},t) && \text{mass conservation} \\
     0 &= g(H,\mathbf{u})   && \text{momentum conservation}
\end{align*}
\vspace{-5mm}
    \begin{itemize}
    \item[$\circ$] \emph{is implicit time-stepping required for DAEs anyway?}
    \end{itemize}
\item velocity variables exist at positive-thickness locations:
    $$\mathbf{u}_i \text{ exists } \quad \Longleftarrow \quad H_i > 0 \iff h_i > b_i$$
\item some ODE solvers can handle \emph{events}:
    \begin{itemize}
    \item[$\circ$] ice disappears during time step:  $H_i(t)>0 \to H_i(t+\Delta t)=0$
    \item[$\circ$] ice appears during time step:  $H_i(t)=0 \to H_i(t+\Delta t)>0$
    \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{MOL$+$events cannot scale}

\begin{center}
\input{tikz/molevents.tex}
\end{center}

\vspace{-6mm}
\begin{itemize}
\item at each event the ice velocity dimension changes
\end{itemize}
\end{frame}


\begin{frame}{consider a single time step} 
\begin{itemize}
\item semi-discretize time by backward Euler
\item FIXME
\item define closed and convex admissible set
  $$\Kcal := \{\eta : \eta^{2p/(p-1)} \in W^{1,p}_0 (\Omega) \,\text{and}\, \eta \ge 0\}$$
over larger domain $\Omega \subset \RR^2$
\item multiply strong form by $\eta-H$ where $\eta\in \Kcal$, and integrate by parts thoughtfully
\end{itemize}
\begin{block}{definition} 
$H \in \Kcal$ solves the \emph{steady shallow ice sheet problem} if
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
for all $\eta \in \Kcal$
\end{block}
\end{frame}


\begin{frame}{ideas contained in weak formulation} 
\begin{itemize}
\item weak form
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
implies strong form
  $$-\Div \left(\Gamma H^{p+1} |\nabla s|^{p-2} \nabla s  \right) =  a$$
where $H>0$
\item weak form also implies: if $H=0$ then $a \le 0$
\item if $b=0$ then the weak form is equivalent to a constrained minimization problem
  \begin{itemize}
  \item[$\circ$] for general bed $b$ this is not so
  \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{on well-posedness (Jouvet-Bueler 2012)} 
\begin{block}{theorem A.}
if $b=0$ then the variational inequality is equivalent to
  $$\min \, J[u] = \int_{\Omega} \frac{\Gamma}{p} |\grad u|^p - a u$$
over $\eta = u^{(p-1)/(2p)} \in \Kcal$, and this problem is well-posed (existence, uniqueness, stability w.r.t.~data $a$)
\end{block}
\begin{block}{theorem B.}
in general case ($b\ne 0$) there exists a solution
\end{block}
\begin{itemize}
\item proof of B by a fixed-point theorem, of course
\item we really don't know about uniqueness (not just technical)
\end{itemize}
\end{frame}

\end{document}
