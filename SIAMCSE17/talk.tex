\documentclass[hide notes,intlimits]{beamer}

\mode<presentation>
{
  \usetheme{Singapore}
  \usefonttheme{professionalfonts}
  \setbeamertemplate{blocks}[rounded][shadow=true]
  \setbeamercovered{transparent}
}

% load packages
\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[multidot]{grffile}
\usepackage{verbatim,empheq}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows}
\usepackage{animate}
\usepackage{amsmath,verbatim}

% see http://tex.stackexchange.com/questions/86188/labelling-with-arrows-in-an-automated-way

\newif\ifclipme\clipmetrue
\tikzset{labelstyle/.style={LabelStyle/.append style={#1}},linestyle/.style={LineStyle/.append style={#1}}}
\tikzset{LabelStyle/.initial={},LineStyle/.initial={}}

\newcommand{\mathWithDescription}[4][]{{%
    \tikzset{#1}%
    \tikz[baseline]{
        \node[draw=red,rounded corners,anchor=base] (m#4) {$\displaystyle#2$};
        \ifclipme\begin{pgfinterruptboundingbox}\fi
            \node[above of=m#4,font=\strut, LabelStyle] (l#4) {#3};
            \draw[-,red, LineStyle] (l#4) to (m#4);
        \ifclipme\end{pgfinterruptboundingbox}\fi
    }%
}}

\newcommand{\mathWithDescriptionStarred}[3][]{{%
    \clipmefalse%
    \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
}}

\newcounter{mathLabelNode}

\newcommand{\mathLabelBox}[3][]{%
   \stepcounter{mathLabelNode}%
   \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
   \vphantom{\mathWithDescriptionStarred[#1]{#2}{#3}{\themathLabelNode}}%
}

\definecolor{dark red}{HTML}{E41A1C}
\definecolor{dark green}{HTML}{4DAF4A}
\definecolor{dark violet}{HTML}{984EA3}
\definecolor{dark blue}{HTML}{084594}
\definecolor{dark orange}{HTML}{FF7F00}
\definecolor{light blue}{HTML}{377EB8}
\definecolor{light red}{HTML}{FB9A99}
\definecolor{light violet}{HTML}{CAB2D6}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\Kcal}{\mathcal{K}}
\newcommand{\Xcal}{\mathcal{X}}

\newcommand{\bF}{\mathbf{F}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bX}{\mathbf{X}}

\newcommand{\bq}{\mathbf{q}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bx}{\mathbf{x}}

\newcommand{\Div}{\nabla\cdot}
\newcommand{\eps}{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\lap}{\triangle}
\renewcommand{\bar}{\overline}

\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}


\newenvironment{transbox}[1][]{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,text width=\textwidth,fill=white, fill opacity=#1,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}}


%\title[Implicit time-stepping for the cryosphere]{Implicit time-stepping for the cryosphere}
\title{Implicit time-stepping for the cryosphere}

\author[Bueler]{Ed Bueler}

\institute[UAF]{
  \scriptsize Dept of Mathematics and Statistics and Geophysical Institute \\

  University of Alaska Fairbanks \\
  
  \tiny $^{}$ \\
  \tiny supported by NASA grant \# NNX13AM16G
}

\titlegraphic{\includegraphics[width=\textwidth]{andycoast.png}}

\setbeamerfont{date}{size=\scriptsize}
\date{}

\AtBeginSection[]
{
  \begin{frame}<beamer>
    \frametitle{Outline}
    %\tableofcontents[currentsection,hideallsubsections]
    \tableofcontents[currentsection]
  \end{frame}
}


\begin{document}

%\graphicspath{{figs/}{../commonfigs/}}
\graphicspath{{../commonfigs/}}

\begin{frame}
\vspace{10mm}
  \titlepage
  \begin{center}
  \tiny SIAM CSE \quad 2 March, 2017
  \end{center}
\end{frame}


\begin{frame}{approach: MOL + events}

\begin{itemize}
\item FIXME
\end{itemize}

\begin{center}
\input{tikz/molevents.tex}
\end{center}
\end{frame}


\begin{frame}{the standard model}

\begin{itemize}
\item velocity $\mathbf{u}(\bx,t)$, pressure $p(\bx,t)$; Newtonian Navier-Stokes:
\begin{align*}
\nabla \cdot \mathbf{u} &= 0 \\
\rho \left(\mathbf{u}_t + \mathbf{u}\cdot\nabla \mathbf{u}\right) &= -\nabla p + \nu \nabla^2 \mathbf{u} + \rho \mathbf{g}
\end{align*}
\item notation: $\tau_{ij}$ deviatoric stress, $\mathbf{D}u_{ij}$ strain rate tensor
\item the standard ice flow model is power-law Stokes:
\begin{align*}
\nabla \cdot \mathbf{u} &= 0 &&\text{\emph{incompressibility}} \\
0 &= - \nabla p + \nabla \cdot \tau_{ij} + \rho \mathbf{g} &&\text{\emph{slow stress balance}} \\
\mathbf{D}u_{ij} &= A \left|\tau_{ij}\right|^{n-1} \tau_{ij} &&\text{\emph{Glen flow law}}
\end{align*}
\item $1.8 < n < 4.0$ ?  \quad \alert{when in doubt: $n=3$}
\medskip
\item $A>0$ ``ice softness'' varies strongly with temperature
\end{itemize}
\end{frame}


\begin{frame}{SIA: velocity}
 
\begin{itemize}
\item $b(x,y)$ is bedrock elevation (data)
\item $s(x,y,t)$ is ice surface elevation (unknown)
\item let $p=n+1>2$
\item assume: no sliding and isothermal
\item horizontal ice velocity is given by: 
  $${\bf U}  =  - \frac{p}{p+1} \Gamma \left[ (s-b)^p - (s - z)^p  \right] 
|\nabla s |^{p-2} \nabla s$$
where $\Gamma > 0$ combines gravity, ice density, ice softness
\end{itemize}
\end{frame}


\begin{frame}{SIA plus mass conservation in steady state}

\begin{itemize}
\item $a(x,y)$ is snowfall minus melt rate (data)
  \begin{itemize}
  \item[$\circ$] a.k.a.~``surface mass balance''
  \end{itemize}
\item mass conservation in steady state: 
  $$\Div \left(  \int_b^s {\bf U}\, dz \right)  =  a$$
\item shallow ice approximation + (steady) mass conservation:
  $$-\Div \left(\Gamma (s-b)^{p+1} | \nabla s |^{p-2} \nabla s\right) =  a$$
  \begin{itemize}
  \vspace{-0.2in}
  \item[$\circ$] this is ``the SIA equation'' for ice sheet geometry
  \item[$\circ$] like Poisson equation $-\Div (D \grad u) = f$
  \item[$\circ$] $p$-Laplace-ish \dots but coefficient $(s-b)^{p+1} \to 0$ at margins
  \end{itemize}
\item equation above is simplest model for turning data of problem ($b$ and $a$) into ice sheet geometry and velocity ($s$ and $U$)
\end{itemize}
\end{frame}


\begin{frame}{SIA equation is constrained} 
\begin{itemize}
\item $H=s-b$ is ice thickness
\item thickness is a nonnegative quantity!
\item steady state equation ``strong form''
  $$-\Div \left(\Gamma H^{p+1} |\nabla s|^{p-2} \nabla s  \right) =  a$$
applies only where
  $$s>b \qquad \iff \qquad H > 0$$
\end{itemize}
\end{frame}


\begin{frame}{weak formulation by variational inequality} 
\begin{itemize}
\item define closed and convex admissible set
  $$\Kcal := \{\eta : \eta^{2p/(p-1)} \in W^{1,p}_0 (\Omega) \,\text{and}\, \eta \ge 0\}$$
over larger domain $\Omega \subset \RR^2$
\item multiply strong form by $\eta-H$ where $\eta\in \Kcal$, and integrate by parts thoughtfully
\end{itemize}
\begin{block}{definition} 
$H \in \Kcal$ solves the \emph{steady shallow ice sheet problem} if
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
for all $\eta \in \Kcal$
\end{block}
\end{frame}


\begin{frame}{ideas contained in weak formulation} 
\begin{itemize}
\item weak form
  $$\int_{\Omega}  \Gamma H^{p+1} |\grad s|^{p-2} \grad s \cdot \grad(\eta - H)  
\ge \int_{\Omega} a (\eta - H)$$
implies strong form
  $$-\Div \left(\Gamma H^{p+1} |\nabla s|^{p-2} \nabla s  \right) =  a$$
where $H>0$
\item weak form also implies: if $H=0$ then $a \le 0$
\item if $b=0$ then the weak form is equivalent to a constrained minimization problem
  \begin{itemize}
  \item[$\circ$] for general bed $b$ this is not so
  \end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{on well-posedness (Jouvet-Bueler 2012)} 
\begin{block}{theorem A.}
if $b=0$ then the variational inequality is equivalent to
  $$\min \, J[u] = \int_{\Omega} \frac{\Gamma}{p} |\grad u|^p - a u$$
over $\eta = u^{(p-1)/(2p)} \in \Kcal$, and this problem is well-posed (existence, uniqueness, stability w.r.t.~data $a$)
\end{block}
\begin{block}{theorem B.}
in general case ($b\ne 0$) there exists a solution
\end{block}
\begin{itemize}
\item proof of B by a fixed-point theorem, of course
\item we really don't know about uniqueness (not just technical)
\end{itemize}
\end{frame}

\end{document}
