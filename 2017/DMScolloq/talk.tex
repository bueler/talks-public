\documentclass[hide notes,intlimits,usenames,dvipsnames]{beamer}

\mode<presentation>
{
  \usetheme{Singapore}
  \usefonttheme{professionalfonts}
  \setbeamertemplate{blocks}[rounded][shadow=true]
  \setbeamercovered{transparent}
  \setbeamertemplate{footline}[frame number]
}

% load packages
\usepackage[english]{babel}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[multidot]{grffile}
\usepackage{verbatim,empheq}

\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows}
\usetikzlibrary{decorations.pathreplacing}

\usepackage{animate}
\usepackage{amsmath,verbatim}

% see http://tex.stackexchange.com/questions/86188/labelling-with-arrows-in-an-automated-way

\newif\ifclipme\clipmetrue
\tikzset{labelstyle/.style={LabelStyle/.append style={#1}},linestyle/.style={LineStyle/.append style={#1}}}
\tikzset{LabelStyle/.initial={},LineStyle/.initial={}}

\newcommand{\mathWithDescription}[4][]{{%
    \tikzset{#1}%
    \tikz[baseline]{
        \node[draw=red,rounded corners,anchor=base] (m#4) {$\displaystyle#2$};
        \ifclipme\begin{pgfinterruptboundingbox}\fi
            \node[above of=m#4,font=\strut, LabelStyle] (l#4) {#3};
            \draw[-,red, LineStyle] (l#4) to (m#4);
        \ifclipme\end{pgfinterruptboundingbox}\fi
    }%
}}

\newcommand{\mathWithDescriptionStarred}[3][]{{%
    \clipmefalse%
    \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
}}

\newcounter{mathLabelNode}

\newcommand{\mathLabelBox}[3][]{%
   \stepcounter{mathLabelNode}%
   \mathWithDescription[#1]{#2}{#3}{\themathLabelNode}%
   \vphantom{\mathWithDescriptionStarred[#1]{#2}{#3}{\themathLabelNode}}%
}

\definecolor{dark red}{HTML}{E41A1C}
\definecolor{dark green}{HTML}{4DAF4A}
\definecolor{dark violet}{HTML}{984EA3}
\definecolor{dark blue}{HTML}{084594}
\definecolor{dark orange}{HTML}{FF7F00}
\definecolor{light blue}{HTML}{377EB8}
\definecolor{light red}{HTML}{FB9A99}
\definecolor{light violet}{HTML}{CAB2D6}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\Kcal}{\mathcal{K}}
\newcommand{\Xcal}{\mathcal{X}}

\newcommand{\bF}{\mathbf{F}}
\newcommand{\bQ}{\mathbf{Q}}
\newcommand{\bU}{\mathbf{U}}
\newcommand{\bX}{\mathbf{X}}

\newcommand{\bq}{\mathbf{q}}
\newcommand{\bu}{\mathbf{u}}
\newcommand{\bv}{\mathbf{v}}
\newcommand{\bx}{\mathbf{x}}

\newcommand{\Div}{\nabla\cdot}
\newcommand{\eps}{\epsilon}
\newcommand{\grad}{\nabla}
\newcommand{\lap}{\triangle}
\renewcommand{\bar}{\overline}

\newcommand{\ip}[2]{\ensuremath{\left<#1,#2\right>}}


\newenvironment{transbox}[1][]{%
\begin{tikzpicture}
\node[drop shadow,rounded corners,text width=\textwidth,fill=white, fill opacity=#1,text opacity=1] \bgroup
}{
\egroup;\end{tikzpicture}}


\title{Optimal solvers for partial differential equations}

\author[Bueler]{Ed Bueler}

\institute[UAF]{
  \scriptsize Dept of Mathematics and Statistics and Geophysical Institute \\

  University of Alaska Fairbanks
}

%\titlegraphic{\includegraphics[width=\textwidth]{andycoast.png}}

\beamertemplatenavigationsymbolsempty   % remove faint and silly navigation symbols at bottom
\renewcommand{\insertnavigation}[1]{}   % remove section headings from top of each slide

\setbeamerfont{date}{size=\scriptsize}
\date{}

%\AtBeginSection[]
%{
%  \begin{frame}<beamer>
%    \frametitle{Outline}
%    %\tableofcontents[currentsection,hideallsubsections]
%    \tableofcontents[currentsection]
%  \end{frame}
%}


\begin{document}

%\graphicspath{{../../old/commonfigs/}}

\begin{frame}
\vspace{10mm}
  \titlepage
  \begin{center}
  \tiny DMS Colloquium \quad 28 November, 2017
  \end{center}
\end{frame}

  \begin{frame}
    \frametitle{Outline}
    \tableofcontents
  \end{frame}


\section{approximately solving PDEs on a grid}

%\begin{frame}{ice sheet flows and their boundaries}
%\begin{columns}
%\begin{column}{0.45\textwidth}
%\begin{itemize}
%\item surface slope is discontinuous at grounded margins
%\end{itemize}
%\end{column}
%\begin{column}{0.55\textwidth}
%FIXME
%\end{column}
%\end{columns}
%\end{frame}


\begin{frame}{example: Poisson equation}

\begin{itemize}
\item for most of this talk I'll use just two examples

\bigskip
\item[\textbf{1.}] \emph{Poisson equation} with Dirichlet boundary conditions:
	    $$- \grad^2 u = f \qquad \text{ on } \Omega \subset \RR^d \text{ with } u\big|_{\partial \Omega} = g,$$
    \vspace{-5mm}
	\begin{itemize}
	\item[$\circ$] a linear elliptic PDE problem
	\item[$\circ$] recall that $\grad^2 u = \Div \left(\grad u\right) = u_{xx}+u_{yy}+u_{zz}$
	\item[$\circ$] will use dimension $d=2$ or $d=3$
	\item[$\circ$] will use various domains $\Omega$
		\begin{itemize}
        \item including a cube and a snowflake fractal \hfill\begin{tikzpicture}[scale=1.0,baseline]
  \draw[line width=1.000000pt] (-0.866025,0.500000) -- (-0.673575,0.500000);
  \draw[line width=1.000000pt] (-0.673575,0.500000) -- (-0.577350,0.666667);
  \draw[line width=1.000000pt] (-0.577350,0.666667) -- (-0.481125,0.500000);
  \draw[line width=1.000000pt] (-0.481125,0.500000) -- (-0.288675,0.500000);
  \draw[line width=1.000000pt] (-0.288675,0.500000) -- (-0.192450,0.666667);
  \draw[line width=1.000000pt] (-0.192450,0.666667) -- (-0.288675,0.833333);
  \draw[line width=1.000000pt] (-0.288675,0.833333) -- (-0.096225,0.833333);
  \draw[line width=1.000000pt] (-0.096225,0.833333) -- (0.000000,1.000000);
  \draw[line width=1.000000pt] (0.000000,1.000000) -- (0.096225,0.833333);
  \draw[line width=1.000000pt] (0.096225,0.833333) -- (0.288675,0.833333);
  \draw[line width=1.000000pt] (0.288675,0.833333) -- (0.192450,0.666667);
  \draw[line width=1.000000pt] (0.192450,0.666667) -- (0.288675,0.500000);
  \draw[line width=1.000000pt] (0.288675,0.500000) -- (0.481125,0.500000);
  \draw[line width=1.000000pt] (0.481125,0.500000) -- (0.577350,0.666667);
  \draw[line width=1.000000pt] (0.577350,0.666667) -- (0.673575,0.500000);
  \draw[line width=1.000000pt] (0.673575,0.500000) -- (0.866025,0.500000);
  \draw[line width=1.000000pt] (0.866025,0.500000) -- (0.769800,0.333333);
  \draw[line width=1.000000pt] (0.769800,0.333333) -- (0.866025,0.166667);
  \draw[line width=1.000000pt] (0.866025,0.166667) -- (0.673575,0.166667);
  \draw[line width=1.000000pt] (0.673575,0.166667) -- (0.577350,0.000000);
  \draw[line width=1.000000pt] (0.577350,0.000000) -- (0.673575,-0.166667);
  \draw[line width=1.000000pt] (0.673575,-0.166667) -- (0.866025,-0.166667);
  \draw[line width=1.000000pt] (0.866025,-0.166667) -- (0.769800,-0.333333);
  \draw[line width=1.000000pt] (0.769800,-0.333333) -- (0.866025,-0.500000);
  \draw[line width=1.000000pt] (0.866025,-0.500000) -- (0.673575,-0.500000);
  \draw[line width=1.000000pt] (0.673575,-0.500000) -- (0.577350,-0.666667);
  \draw[line width=1.000000pt] (0.577350,-0.666667) -- (0.481125,-0.500000);
  \draw[line width=1.000000pt] (0.481125,-0.500000) -- (0.288675,-0.500000);
  \draw[line width=1.000000pt] (0.288675,-0.500000) -- (0.192450,-0.666667);
  \draw[line width=1.000000pt] (0.192450,-0.666667) -- (0.288675,-0.833333);
  \draw[line width=1.000000pt] (0.288675,-0.833333) -- (0.096225,-0.833333);
  \draw[line width=1.000000pt] (0.096225,-0.833333) -- (0.000000,-1.000000);
  \draw[line width=1.000000pt] (0.000000,-1.000000) -- (-0.096225,-0.833333);
  \draw[line width=1.000000pt] (-0.096225,-0.833333) -- (-0.288675,-0.833333);
  \draw[line width=1.000000pt] (-0.288675,-0.833333) -- (-0.192450,-0.666667);
  \draw[line width=1.000000pt] (-0.192450,-0.666667) -- (-0.288675,-0.500000);
  \draw[line width=1.000000pt] (-0.288675,-0.500000) -- (-0.481125,-0.500000);
  \draw[line width=1.000000pt] (-0.481125,-0.500000) -- (-0.577350,-0.666667);
  \draw[line width=1.000000pt] (-0.577350,-0.666667) -- (-0.673575,-0.500000);
  \draw[line width=1.000000pt] (-0.673575,-0.500000) -- (-0.866025,-0.500000);
  \draw[line width=1.000000pt] (-0.866025,-0.500000) -- (-0.769800,-0.333333);
  \draw[line width=1.000000pt] (-0.769800,-0.333333) -- (-0.866025,-0.166667);
  \draw[line width=1.000000pt] (-0.866025,-0.166667) -- (-0.673575,-0.166667);
  \draw[line width=1.000000pt] (-0.673575,-0.166667) -- (-0.577350,0.000000);
  \draw[line width=1.000000pt] (-0.577350,0.000000) -- (-0.673575,0.166667);
  \draw[line width=1.000000pt] (-0.673575,0.166667) -- (-0.866025,0.166667);
  \draw[line width=1.000000pt] (-0.866025,0.166667) -- (-0.769800,0.333333);
  \draw[line width=1.000000pt] (-0.769800,0.333333) -- (-0.866025,0.500000);
\end{tikzpicture}
        \end{itemize}
	\item[$\circ$] $f(x,y,z)$ and $g(x,y,z)$ given
	\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{example: minimal surface equation}

\begin{itemize}
\item[\textbf{2.}] \emph{minimal surface equation (MSE)} with Dirichlet b.c.s:
	    $$- \grad\cdot \left(\frac{\grad u}{\sqrt{1 + |\grad u|^2}}\right) = 0  \qquad \text{ with } u\big|_{\partial \Omega} = g.$$
    \vspace{-2mm}
	\begin{itemize}
	\item[$\circ$] a nonlinear elliptic PDE in 2D
	\item[$\circ$] specifically: $\Omega = [0,1]^2$
	\item[$\circ$] the solution $u(x,y)$ gives the height of a soap bubble, in zero gravity, which spans a wire frame with height $z=g(x,y)$
	\end{itemize}

\begin{center}
\begin{tikzpicture}[scale=1.6]
  \draw[->,gray,very thin] (0.0,0.0) -- (1.2,0.0) node[below] {$x$};
  \draw[->,gray,very thin] (0.0,0.0) -- (-0.75,0.75) node[left] {$y$};
  \draw[line width=1.0pt] (0.0,0.0) -- (1.0,0.0) -- (0.45,0.55) -- (-0.55,0.55) -- (-0.275,0.5) -- cycle;
  %\draw[dashed,thin] (-0.275,0.275) -- (-0.275,0.5);
  %\node at (-0.33,0.42) {$H$};
\end{tikzpicture}
\end{center}

\item both examples 1 \& 2:
	\begin{itemize}
	\item[$\circ$] are well-posed PDE BVPs
	\item[$\circ$] derivable from variational principles
	\item[$\circ$] seek $u \in H_g^1(\Omega)$ \dots from an \alert{$\infty$-dimensional vector space}
	\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{approximation: finite differences}
\begin{itemize}
\item a PDE BVP is a system of $\infty$ equations in $\infty$ unknowns
\item some problems can be solved exactly
	\begin{itemize}
	\item[$\circ$] \emph{example}.  $u(x,y)=x^2-y^2$ solves $-\grad^2 u = 0$
	\end{itemize}
\item most problems are not solved exactly
	\begin{itemize}
	\item[$\circ$] approximation by $N$ equations in $N$ unknowns where $N \ll \infty$
	\end{itemize}
\item e.g.~by \emph{finite difference} approximations:
	    $$f'(x) = \lim_{h \to 0} \frac{f(x+h)-f(x)}{h} \approx \frac{f(x+h)-f(x)}{h}$$
	\begin{itemize}
    \vspace{-5mm}
	\item[$\circ$] in 2D:
	    $$u_{xx}+u_{yy} \approx \frac{u_{i+1,j} + u_{i-1,j} + u_{i,j+1} + u_{i,j-1} - 4 u_{ij}}{h^2}$$
	(if the grid has equal spacing $h$ in $x$ and $y$ directions)
	\item[$\circ$] ``finite difference method'' is FDM
	\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}{structured grids}
\begin{itemize}
\item for a majority of this talk I'll use \emph{structured grids}
	\begin{itemize}
	\item[$\circ$] for $\Omega=[0,1]^d$, anyway
	\end{itemize}
\item they will have various resolutions
	\begin{itemize}
	\item[$\circ$] grid denoted $\Omega^{(k)}$
		\begin{itemize}
        \item $k$ is the \emph{level}
        \item $N_k$ points
        \item equal spacing $h_k$ in each direction
        \end{itemize}
    \item[$\circ$] the coarsest one is always $\Omega^{(0)}$
    \item[$\circ$] typically: $N_{k+1} = 2^d N_k$ (or nearly so)
	\end{itemize}

\bigskip
\begin{tikzpicture}[scale=1.7]
  \pgfmathsetmacro\half{1.0/2.0}
  \draw[xstep=\half,ystep=\half,black,thin] (0.0,0.0) grid (1.0,1.0);
  \node at (0.5,-0.4) {$\Omega^{(0)}$};
\end{tikzpicture}
\quad
\begin{tikzpicture}[scale=1.7]
  \pgfmathsetmacro\fourth{1.0/4.0}
  \draw[xstep=\fourth,ystep=\fourth,black,thin] (0.0,0.0) grid (1.0,1.0);
  \node at (0.5,-0.4) {$\Omega^{(1)}$};
\end{tikzpicture}
\quad
\begin{tikzpicture}[scale=1.7]
  \pgfmathsetmacro\eigth{1.0/8.0}
  \draw[xstep=\eigth,ystep=\eigth,black,thin] (0.0,0.0) grid (1.0,1.0);
  \node at (0.5,-0.4) {$\phantom{\Omega^{(2)}}\dots\phantom{\Omega^{(2)}}$};
\end{tikzpicture}
\quad
\begin{tikzpicture}[scale=1.7]
  \pgfmathsetmacro\sixteenth{1.0/16.0}
  \draw[xstep=\sixteenth,ystep=\sixteenth,black,thin] (0.0,0.0) grid (1.0,1.0);
  \node at (0.5,-0.4) {$\Omega^{(k)}$};
\end{tikzpicture}
\end{itemize}
\end{frame}


\begin{frame}{linear system with sparse matrix}
\begin{itemize}
\item FIXME show
\end{itemize}
\end{frame}


\begin{frame}{approximation: finite elements}
\begin{itemize}
\item another way to discretize uses the \emph{weak form} of the PDE
\item \dots and a (generally) unstructured \emph{mesh}, FIXME show mesh on Koch
\item \dots and an $N$-dimensional subspace $\mathcal{X}_N \subset H^1(\Omega)$,
\item \dots and a basis of \emph{tent functions} $\psi_i(x,y)$ FIXME show tent
\item weak form from integrating PDE (\emph{strong form}) by parts:
    $$\int_\Omega \grad u \cdot \grad v \stackrel{\ast}{=} \int_\Omega f v \qquad \forall v \in H_0^1(\Omega)$$
\item by supposing [2D] $u(x,y) = \sum_j u_{j} \psi_{j}(x,y)$ and requiring $\ast$ for all $v=\psi_i$ we get system of $N$ eqns in $N$ unknowns FIXME show spy
\item ``finite element method'' is FEM
\end{itemize}
\end{frame}


\begin{frame}{FIXME}
\begin{itemize}
\item FIXME  SPD?
\end{itemize}
\end{frame}


\section{what is an ``optimal solver''?}

\begin{frame}{define ``optimal''}
\begin{itemize}
\item consider $N$ equations in $N$ unknowns $\mathbf{F}(\mathbf{u}) = 0$
	\begin{itemize}
	\item[$\circ$] $\mathbf{F}:\RR^N \to \RR^N$, the \emph{residual}, is generally nonlinear
	\item[$\circ$] but $\mathbf{F}(\mathbf{w}) = \mathbf{b} - A \mathbf{w}$ is the linear case
	\end{itemize}
\item for FDM and FEM discretizations of a PDE, evaluating $\mathbf{F}(\mathbf{w})$, for given $\mathbf{w}$, requires $O(N)$ work

\bigskip
\indent \item[\textbf{def.}]  an algorithm which solves $\mathbf{F}(\mathbf{u}) = 0$ is \emph{optimal} if it does $O(N)$ or $O(N\log N)$ work

\bigskip
\item  ``solves'' means that it generates $\mathbf{u}_n$ so that
	    $$\frac{\|\mathbf{F}(\mathbf{u}_n)\|}{\|\mathbf{F}(\mathbf{u}_0)\|} \le \text{tol}$$
where $\mathbf{u}_0$ is an initial guess
\end{itemize}
\end{frame}

\begin{frame}{example: solving tridiagonal matrices}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}

\begin{frame}{non-example:  banded Gaussian elimination (2D,3D)}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}

\begin{frame}{tangent: spectral methods}
\begin{itemize}
\item FIXME
\item spectral methods show that pursuit of optimality is \emph{not} the only good goal
\end{itemize}
\end{frame}

\begin{frame}{Krylov methods}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}

\begin{frame}{rate of convergence of CG}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}


\section{multigrid}

\begin{frame}{FIXME}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}

\begin{frame}{FIXME}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}

\begin{frame}{an optimality lemma}

conditions under which multgrid cycles as preconditioners for CG give optimal solver
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}


\section{nonlinear problems and unstructured grids}

\begin{frame}{FIXME}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}



\section{parallel scaling, and barriers to optimality}

\begin{frame}{FIXME}
\begin{itemize}
\item FIXME
\end{itemize}
\end{frame}


\end{document}
